---
# zabbix_inventory.yml
plugin: zabbix.zabbix.zabbix_inventory

#env ZABBIX_API_URLでInject (CommunityだとZABBIX_SERVERでInject)
#zabbix_api_url: "https://xxx.xxx.xxx.xxx"

#env ZABBIX_USERでInject(CommunityだとZABBIX_USERNAMEでInject)
#zabbix_user: Admin

#env ZABBIX_PASSWORDでInject
#zabbix_password: "xxxxxxxxx"

validate_certs: false

host_zapi_query:
  selectInterfaces: 'extend'

cache: true
cache_plugin: jsonfile
cache_timeout: 7200
cache_connection: /tmp/zabbix_inventory
query:
  selectGroups: ['name']
  selectInterfaces: ['ip']

compose:
  zabbix_verbose_status: zabbix_status.replace("1", "Disabled").replace("0", "Enabled")
  ansible_host: (zbx_interfaces | selectattr('type','==','1') | first).ip
  zabbix_ip_list: zabbix_interfaces | map(attribute='ip')

groups:
  enabled: zabbix_status == "0"
  disabled: zabbix_status == "1"
keyed_groups:
  - key: zabbix_groups | map(attribute='name')
    separator: ""




